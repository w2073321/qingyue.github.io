$(document).ready(function(){var s=function(){function s(){window.gtla=window.gtla||[];var s=this;this.goodSKU={md:[],mr:[],mp:[]},s.pageBrowser(),s.lazyonload(),s.loadimg(),$(document).on("click",".logsss_event",function(){var e=$(this).data("logsss-event-value");e=$.trim(e);var t=s.optLogssDataValue(e,"trackEvent"),a=$(this).data("logsss-const-value");s.optLogssConstValue(a,t),s.saveFmdInfo(t),s.getPreviousUrl(t),t.plf="m",window.gtla.push(t)}),$(document).on("tap",".logsss_event_cl",function(){var e=$(this).data("logsss-const-value"),t=$.trim($(this).closest(".logsss_event_ps").data("logsss-event-value")),a=s.optLogssDataValue(t,"trackEvent");s.optLogssConstValue(e,a),s.saveFmdInfo(a),s.getPreviousUrl(a),a.ubcta&&a.ubcta.sckw&&sessionStorage.setItem("logsss-search-sckw",a.ubcta.sckw),a.plf="m",window.gtla.push(a)}),$("#js_searchTips").on("tap",".js-popular-search",function(){var e=$(this),t=e.index()+1,a=e.text(),o=e.data("type"),n=s.searchParams({searchTpye:"T",pos:t,val:a,type:o});n.plf="m",window.gtla.push(n)}),$("#js_startSearch").on("tap",function(){var e=($(this),$("#js_topSeachInput").val()),t=s.searchParams({searchTpye:"",pos:"",val:e});t.plf="m",window.gtla.push(t)}),$("#js_topSeachInput").on("keydown",function(s){13==s.keyCode&&$("#js_startSearch").trigger("tap")}),$("#js-seoWords").on("tap","li",function(){var e=$(this),t=e.find("a").text(),a=$(this).index()+1,o=s.searchParams({searchTpye:"C",pos:a,val:t});o.plf="m",window.gtla.push(o)}),$(".logsss-seo-words").on("tap","a",function(){var e=$(this),t=e.text(),a=$(this).index()+1,o=s.searchParams({searchTpye:"R",pos:a,val:t});o.plf="m",window.gtla.push(o)});var e;$("#js_topSeachInput").on("keyup",function(){var s=$(this);e=s.val()}),$("#js_searchTips").on("tap",".js-lenovo-search",function(){var t=$(this),a=t.index()+1,o=t.text(),n=s.searchParams({searchTpye:"L",pos:a,val:o,relatedVal:e});n.plf="m",window.gtla.push(n)})}s.prototype={constructor:s,MAX_BRO_NUM:8,lazyonload:function(s){var e=this;s||(s=$(".js_gdexp_lazy")),s.length&&s.lazyload({data_attribute:"original",threshold:500,effect:"show",failure_limit:60,load:function(s,t){e.getsku($(this)),e.sendsku()}})},loadimg:function(s){var e=this;s||(s=$(".logsss-img")),s.length&&s.each(function(){e.getsku($(this)),e.sendsku()})},pageBrowser:function(){var s=this,e=s.getSkuInfo(),t=s.getPageModule(),a={trackType:"trackBrowser"};a.skuinfo=e,t&&(a.pagemodule=t);var o=s.goodsFast();o&&(a.cl=o,a.pl=o,a.pm="mpop");var n=sessionStorage.getItem("logsss-search-type");"search"==n?sessionStorage.getItem("logsss-search-type")&&sessionStorage.setItem("logsss-search-type",""):"c"==$('meta[name="GLOBEL:spcb"]').attr("content")||n||sessionStorage.getItem("logsss-search-sckw")&&sessionStorage.setItem("logsss-search-sckw",""),s.getPreviousUrl(a),a.plf="m",window.gtla.push(a)},goodsFast:function(){var s=$("input[name='goods-fast']").val(),e="";if(s){try{e=window.top.location.href}catch(t){if(window.parent)try{e=window.parent.location.href}catch(a){e=""}}""===e&&(e=document.referrer)}return e},getPreviousUrl:function(s){var e=$('meta[name="GLOBEL:spcb"]').attr("content");$.cookie("previous-url")&&"c"==e&&(s.pl=$.cookie("previous-url"))},getSkuInfo:function(){var s=$('meta[name="GLOBEL:skuinfo"]').attr("content");return s&&/'/.test(s)&&(s=s.replace(/'/g,'"'),s=JSON.parse(s)),s},getPageModule:function(){var s=$('meta[name="pagemodule"]').attr("content");return s},optLogssDataValue:function(s,e){if(!s&&e)return s={},s.trackType=e,s;s=s.replace(/'/g,'"');var t=JSON.parse(s);return e&&(t.trackType=e),t},optLogssConstValue:function(s,e){if(!s)return e;s=s.replace(/'/g,'"');var t=JSON.parse(s);for(var a in t)if(/^var/.test(a)){var o=t[a].split("|");window[o[0]]&&(e[o[1]]=window[o[0]])}else if("isFromSearch"===a){window.filterInfo&&(e.filter=window.filterInfo);var n=this.getGoodsUbcta();n&&Object.keys(n).length>0&&(e.ubcta||(e.ubcta={}),n.sckw&&(e.ubcta.sckw=n.sckw,n.sk&&(e.ubcta.sk=n.sk)),n.fmd&&(e.ubcta.fmd=n.fmd),e.ubcta.sckw&&n.sk&&(e.ubcta.sk=n.sk))}else if("channel"===a){var n=this.getGoodsUbcta();n&&Object.keys(n).length>0&&(e.ubcta=n),e.ubcta||(e.ubcta={}),e.ubcta.channel=t[a],e.skuinfo&&(e.skuinfo.pam=0)}else if("ub"===a){var n=this.getGoodsUbcta();n&&Object.keys(n).length>0&&(e.ubcta||(e.ubcta={}),n.sckw&&(e.ubcta.sckw=n.sckw,n.sk&&(e.ubcta.sk=n.sk)),n.fmd&&(e.ubcta.fmd=n.fmd),e.ubcta.sckw&&n.sk&&(e.ubcta.sk=n.sk)),e.skuinfo&&"ADT"===e.x?e.skuinfo.pam=$("#js_input_quantity").val():e.skuinfo&&(e.skuinfo.pam=0)}else if("x"===a&&"ADT"===t[a])e[a]=t[a],e.skuinfo&&(e.skuinfo.pam=$("#js_input_quantity").val());else if("x"===a&&"BTS"===t[a]){var r=$("#ul-peijian");e.skuinfo=[],e[a]=t[a];var i=$(".master").children("a").data("logsss-event-value");i=i.replace(/'/g,'"');var c=JSON.parse(i);c.skuinfo.pam=1,e.skuinfo.push(c.skuinfo),r.length>0&&r.find("input:checked").each(function(s,t){var a=$(this),o=a.closest("li"),n=o.data("logsss-event-value");n=n.replace(/'/g,'"');var r=JSON.parse(n);r.skuinfo.pam=1,e.skuinfo.push(r.skuinfo)})}else if("ubcta"===a&&"orderID"===t[a]){var u={};u.orderID=$("#lg_order_id").text(),e[a]=u}else if("x"!==a||"checkout"!==t[a]&&"CWP"!==t[a])e[a]=t[a];else{e[a]=t[a];var l=$("#js_cartProList");if(l){var p=l.find("li");e.skuinfo=[],p&&p.length>0&&p.find("input:checked").each(function(s,t){var a=$(this),o=a.closest(".logsss_event_ps"),n=o.data("logsss-event-value"),r=JSON.parse(n.replace(/'/g,'"'));e.skuinfo.push(r.skuinfo)})}}},getSpcb:function(){var s=$('meta[name="GLOBEL:spcb"]').attr("content");return s},saveFmdInfo:function(s){if("mp"===s.pm)sessionStorage.setItem("logsss-search-fmd","mp");else if("md"===s.pm){var e=s.ubcta?s.ubcta.mdlc:"_";sessionStorage.setItem("logsss-search-fmd","md_"+e)}else if("mr"===s.pm){var t=s.ubcta?s.ubcta.mrlc:"_";sessionStorage.setItem("logsss-search-fmd","mr_"+t)}},getGoodsUbcta:function(){if(sessionStorage){var s={},e=sessionStorage.getItem("logsss-search-sckw");e&&(s.sckw=e);var t=sessionStorage.getItem("logsss-search-fmd");t&&(s.fmd=t);var a=sessionStorage.getItem("searchType");return a&&(s.sk=a),s}},getsku:function(s){var e=$.trim(s.data("logsss-browser-value")),t=this.optLogssDataValue(e,"trackBrowser");if(t){var a=t.pm;a&&this.goodSKU[a]&&this.goodSKU[a].push(t.bv)}},sendsku:function(){var s=this;setTimeout(function(){for(var e in s.goodSKU){var t=s.goodSKU[e],a={trackType:"trackBrowser"};if(t.length>0)if("md"===e?a.pm="md":"mr"===e?a.pm="mr":"mp"===e&&(a.pm="mp"),t.length>0&&t.length<=s.MAX_BRO_NUM)a.ubcta=t,s.getPreviousUrl(a),a.plf="m",window.gtla.push(a);else if(t.length>s.MAX_BRO_NUM)for(;t.length>0;){var o=s.MAX_BRO_NUM;t.length<s.MAX_BRO_NUM&&(o=t.length);var n=t.splice(0,o),r={trackType:"trackBrowser"};r.pm=a.pm,r.ubcta=n,s.getPreviousUrl(r),r.plf="m",window.gtla.push(r)}s.goodSKU[e].length=0}},500)},optRcmdLogsssData:function(s,e){$(s).each(function(s,t){var a={};a.x=e,a.skuinfo={},a.skuinfo.sku=t.sku,a.skuinfo.pam=0,a.skuinfo.pc=0,a.skuinfo.k=0,a.ubcta={},a.ubcta.rank=s+1,t.lg_eve_rcmd_value=JSON.stringify(a).replace(/\"/g,"'");var o={};o.pm="mr",o.bv={},o.bv.mrlc=e,o.bv.sku=t.sku,t.lg_bro_rcmd_value=JSON.stringify(o).replace(/\"/g,"'")})},searchParams:function(s){var e;switch(s.type&&"3"==s.type?(e={trackType:"trackEvent"},e.ubcta={at:"1"}):e={trackType:"trackEventNext"},s.searchTpye){case"T":e.siws="";break;case"":e.siws=s.val;break;case"C":e.siws="";break;case"R":e.siws="";break;case"O":e.siws="";break;case"L":e.siws=s.relatedVal}return sessionStorage.setItem("searchType",s.searchTpye),sessionStorage.setItem("logsss-search-sckw",s.val),sessionStorage.setItem("logsss-search-type","search"),e.sk=s.searchTpye,e.sl=s.pos,e.sckw=s.val,e.x="search",e.trackNextType="search",e},getItem:function(s){var e=window.name;if(e){var t=e.split("|%");if(t&&!(t.length<1)){var a=new RegExp(s,"g"),o="";return t.forEach(function(s,e){if(/_glbLP_/g.test(s)&&a.test(s)){var t=s.replace("_glbLP_","");return o=t.split("=")[1],!1}}),o}}},setItem:function(s,e){var t=window.name.indexOf(s);if("-1"!=t){for(var a=window.name.split("|%_glbLP_"),o=0,n=a.length;o<n;o++)"-1"!=a[o].indexOf(s)&&(a[o]=s+"="+e);window.name=a.join("|%_glbLP_")}else window.name=window.name+"|%_glbLP_"+s+"="+e}};var e,t={getInstance:function(){return void 0===e&&(e=new s),e}};return t}();window.gbLogsss=s.getInstance()});